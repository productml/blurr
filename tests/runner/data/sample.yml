Type: ProductML:DTC:Streaming
Version: '2018-03-01'
Description: Level 1 trasnformation from streaming Raw Data

Name: Sessions

Identity: source.user_id
Time: parser.parse(source.event_time)

Store:
  Type: ProductML:DTC:Storage:DynamoDB
  Name: dynamo
  Retention: 180
  Table: ProductML_Test_Sessions

DataGroups:

 - Type: ProductML:DTC:DataGroup:SessionAggregate
   Name: session
   Split: (time - session.end_time).seconds > 1800

   Fields:
     - Name: events
       Type: integer
       Value: session.events + 1
