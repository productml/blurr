Type: ProductML:DTC:Window
Version: '2018-03-01'
Description: Second Level processing for feature generation

Name: ProductMLExample

SourceDTC: Sessions

Anchor:
  Condition: 'True'
  Max: 1


DataGroups:
  - Type: ProductML:DTC:DataGroup:AnchorAggregate
    Name: last_session
    Window:
      Type: count
      Value: -1
      Source: Sessions.sessions

    Fields:
     - Name: events
       Type: integer
       Value: source.events[0]

  - Type: ProductML:DTC:DataGroup:AnchorAggregate
    Name: last_day
    Window:
      Type: day
      Value: -1
      Source: Sessions.sessions

    Fields:
     - Name: total_events
       Type: integer
       Value: sum(source.events)