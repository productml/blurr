Type: ProductML:DTC:Window
Version: '2018-03-01'
Description: Second Level processing for feature generation

Name: ProductMLExample

SourceDTC: Sessions

Anchor:
  Condition: 'True'
  Max: 1


DataGroups:
  - Type: ProductML:DTC:DataGroup:WindowAggregate
    Name: last_session
    WindowType: count
    WindowValue: -1
    Source: Sessions.session

    Fields:
     - Name: events
       Type: integer
       Value: source.events[0]

  - Type: ProductML:DTC:DataGroup:WindowAggregate
    Name: last_day
    WindowType: day
    WindowValue: -1
    Source: Sessions.session

    Fields:
     - Name: total_events
       Type: integer
       Value: sum(source.events)